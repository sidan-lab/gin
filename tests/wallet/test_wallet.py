# flake8: noqa: E501
import unittest

from sidan_gin import Wallet


class TestWalletSigning(unittest.TestCase):

    def setUp(self):
        self.mnemonic = "summer summer summer summer summer summer summer summer summer summer summer summer summer summer summer summer summer summer summer summer summer summer summer summer"
        self.root_key = "xprv1cqa46gk29plgkg98upclnjv5t425fcpl4rgf9mq2txdxuga7jfq5shk7np6l55nj00sl3m4syzna3uwgrwppdm0azgy9d8zahyf32s62klfyhe0ayyxkc7x92nv4s77fa0v25tufk9tnv7x6dgexe9kdz5gpeqgu"
        self.cli_key = (
            "51022b7e38be01d1cc581230e18030e6e1a3e949a1fdd2aeae5f5412154fe82b"
        )

    def test_sign_tx_mnemonic(self):
        self.wallet = Wallet.new_mnemonic(self.mnemonic)
        tx_hex = "84a4008182582004509185eb98edd8e2420c1ceea914d6a7a3142041039b2f12b4d4f03162d56f04018282581d605867c3b8e27840f556ac268b781578b14c5661fc63ee720dbeab663f1a000f42408258390004845038ee499ee8bc0afe56f688f27b2dd76f230d3698a9afcc1b66e0464447c1f51adaefe1ebfb0dd485a349a70479ced1d198cbdf7fe71a15d35396021a0002917d075820bdaa99eb158414dea0a91d6c727e2268574b23efe6e08ab3b841abe8059a030ca0f5d90103a0"
        signature = self.wallet.sign_tx(tx_hex)
        self.assertEqual(
            signature,
            "84a4008182582004509185eb98edd8e2420c1ceea914d6a7a3142041039b2f12b4d4f03162d56f04018282581d605867c3b8e27840f556ac268b781578b14c5661fc63ee720dbeab663f1a000f42408258390004845038ee499ee8bc0afe56f688f27b2dd76f230d3698a9afcc1b66e0464447c1f51adaefe1ebfb0dd485a349a70479ced1d198cbdf7fe71a15d35396021a0002917d075820bdaa99eb158414dea0a91d6c727e2268574b23efe6e08ab3b841abe8059a030ca1008182582089f4b576f05f5aad99bce0bdd51afe48529772f7561bb2ac9d84a4afbda1ecd658404cd1466fcc4579fa9c89656dbbd25ca659cccf2d2783417ef13a1b060bf836fbe8383c10e25c6fa323c1c81a0799e87e6cf3eaa25990113b27953a9836635a01f5d90103a0",
        )

    def test_sign_tx_mnemonic(self):
        self.wallet = Wallet.new_cli(self.cli_key)
        tx_hex = "84a400d90102818258202cb57168ee66b68bd04a0d595060b546edf30c04ae1031b883c9ac797967dd8503018283581d60f95cab9352c14782a366802b7967746a89356e8915c17006149ff68c1a001e84805820923918e403bf43c34b4ef6b48eb2ee04babed17320d8d1b9ff9ad086e86f44ec82581d60f95cab9352c14782a366802b7967746a89356e8915c17006149ff68c1b000000024d74dae2021a000295f50b5820623e03fb3d662e91ccec09c098e017b0a65b9213844d227acb5745709744ecbba104d901029fd87980fff5f6"
        signature = self.wallet.sign_tx(tx_hex)
        self.assertEqual(
            signature,
            "84a400d90102818258202cb57168ee66b68bd04a0d595060b546edf30c04ae1031b883c9ac797967dd8503018283581d60f95cab9352c14782a366802b7967746a89356e8915c17006149ff68c1a001e84805820923918e403bf43c34b4ef6b48eb2ee04babed17320d8d1b9ff9ad086e86f44ec82581d60f95cab9352c14782a366802b7967746a89356e8915c17006149ff68c1b000000024d74dae2021a000295f50b5820623e03fb3d662e91ccec09c098e017b0a65b9213844d227acb5745709744ecbba200d90102818258201b45b2ca587929f56648f7a04073ef35ab5cc6ef438d07d9e5542fec15867ada584098a436f7144bf9d2a477c0acd1b106b1d3de4ecfe1ea6d5fda8dc8636a421939225bbfb72613b5eae8ca913040455395eaf050d5605d06c6c1402e8b89c9990c04d901029fd87980fff5f6",
        )


if __name__ == "__main__":
    unittest.main()
